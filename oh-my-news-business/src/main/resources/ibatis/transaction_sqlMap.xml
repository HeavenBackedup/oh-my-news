<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE sqlMap PUBLIC "-//ibatis.apache.org//DTD SQL Map 2.0//EN" "http://ibatis.apache.org/dtd/sql-map-2.dtd">
<sqlMap namespace="transaction_sqlMap">
    <resultMap id="transaction_resultMap" class="com.oh.my.news.model.po.Transaction">
        <result property="id" column="id" jdbcType="Integer"></result>
        <result property="isDelete" column="isDelete" jdbcType="Integer"></result>
        <result property="sourceUserId" column="source_user_id" jdbcType="INTEGER"></result>
        <result property="targetUserId" column="target_user_id" jdbcType="INTEGER"></result>
        <result property="date" column="date" jdbcType="Date"></result>
        <result property="amount" column="amount" jdbcType="float"></result>
        <result property="message" column="message" jdbcType="String"></result>
        <result property="articleId" column="article_id" jdbcType="Integer"></result>
    </resultMap>
    <resultMap id="transaction_mapResult" class="com.oh.my.news.model.po.TransactionPo">
        <result property="id" column="id" jdbcType="INTEGER"></result>
        <result property="isDelete" column="is_delete" jdbcType="INTEGER"></result>
        <result property="targetName" column="username" jdbcType="INTEGER"></result>
        <result property="date" column="date" jdbcType="DATE"></result>
        <result property="amount" column="amount" jdbcType="FLOAT"></result>
        <result property="message" column="message" jdbcType="VARCHAR"></result>
    </resultMap>
    <insert id="insert_transaction_by_id">
         insert into `transaction`(is_delete,source_user_id,target_user_id,`date`,amount,article_id) values(0,#source_user_id#,#target_user_id#,now(),#amount#,#article_id#);
    </insert>
        <!--select .user.username username from transaction,user where transaction.target_id = user.id and transaction.source_user_id = #id# ...-->
    <select id="queryIn_transaction_by_id" parameterClass="Integer" resultMap="transaction_mapResult" >
          select `transaction`.id,`transaction`.is_delete,`user`.username username,`transaction`.date,`transaction`.amount,`transaction`.message from `transaction`,`user` where `user`.id=`transaction`.source_user_id and `transaction`.target_user_id=#id#;
    </select>
    <select id="queryOut_transaction_by_id" parameterClass="Integer" resultMap="transaction_mapResult" >
        select `transaction`.id,`transaction`.is_delete,`user`.username username,`transaction`.date,`transaction`.amount,`transaction`.message from `transaction`,`user` where `user`.id=`transaction`.target_user_id and `transaction`.source_user_id=#id#;
    </select>
    <!--<select id="querySum_transaction_by_id" parameterClass="Map" resultClass="integer">-->
          <!--select wallet.figure from wallet,transaction,user where user.id=wallet.user_id and user.id=#id# and user.id=transaction.target_user_id ;-->

    <!--</select>-->



</sqlMap>
